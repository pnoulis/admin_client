{"ast":null,"code":"import{useEffect,useState,createRef}from\"react\";import{FORM_STORE}from\"lib/stores\";import{Resizable}from\"re-resizable\";import style from\"./styles/imgfield.module.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useFormContext=FORM_STORE.useFormContext,mime=[\"image/jpeg\",\"image/png\",\"image/gif\",\"image/webp\",\"image/svg+xml\",\"image/tiff\",\"image/bmp\"],mimeAccept=mime.reduce(function(acc,cur){return acc.concat(\",\",cur);});export function ImageField(){var _useFormContext=useFormContext(),fields=_useFormContext.fields,edit=_useFormContext.edit,setForm=_useFormContext.setForm,img=fields.img;if(fields.img instanceof File)return/*#__PURE__*/_jsx(UploadedImage,{fields:fields,edit:edit,setForm:setForm,img:img});else if(!Object.keys(img).length)return/*#__PURE__*/_jsx(UploadImage,{fields:fields,edit:edit,setForm:setForm,img:img});else return/*#__PURE__*/_jsx(ViewImage,{edit:edit,setForm:setForm,img:img});}function UploadedImage(_ref){var fields=_ref.fields,edit=_ref.edit,setForm=_ref.setForm,img=_ref.img;function handleCancel(e){e.preventDefault();setForm(\"setInput\",\"img\",{});}return/*#__PURE__*/_jsxs(\"div\",{className:style.imageUploaded,children:[/*#__PURE__*/_jsx(\"p\",{children:fields.img.name}),/*#__PURE__*/_jsx(\"p\",{onClick:handleCancel,children:\"cancel\"})]});}function UploadImage(_ref2){var edit=_ref2.edit,setForm=_ref2.setForm;var id=(Math.random()+1).toString(36).substring(7);function handleUpload(e){e.preventDefault();if(!edit)return;setForm(\"setInput\",\"img\",e.target.files.item(0));}return/*#__PURE__*/_jsx(\"div\",{className:style.uploadImage,children:/*#__PURE__*/_jsxs(\"label\",{className:style.inputWrapper,htmlFor:id,children:[/*#__PURE__*/_jsx(\"span\",{children:\"upload\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:id,name:\"img\",accept:mimeAccept,onChange:handleUpload})]})});}function ViewImage(_ref3){var fields=_ref3.fields,edit=_ref3.edit,setForm=_ref3.setForm,img=_ref3.img;var imgStyle={display:\"inline-block\",objectFit:\"cover\",width:\"100%\",height:\"100%\"};function handleChange(e){e.preventDefault();if(!edit)return;setForm(\"setInput\",\"img\",{});}return/*#__PURE__*/_jsxs(\"div\",{className:style.viewImage,children:[/*#__PURE__*/_jsx(\"p\",{onClick:handleChange,children:\"change\"}),/*#__PURE__*/_jsx(Resizable,{style:{margin:\"auto\"},minHeight:80,width:\"100%\",height:\"100%\",minWidth:90,maxWidth:300,maxHeight:300,defaultSize:{width:90,height:80},children:/*#__PURE__*/_jsx(\"img\",{style:imgStyle,src:img})})]});}","map":{"version":3,"sources":["/home/pavlos/Office/projects/new/admin-client/src/components/Fields/Image.jsx"],"names":["useEffect","useState","createRef","FORM_STORE","Resizable","style","useFormContext","mime","mimeAccept","reduce","acc","cur","concat","ImageField","fields","edit","setForm","img","File","Object","keys","length","UploadedImage","handleCancel","e","preventDefault","imageUploaded","name","UploadImage","id","Math","random","toString","substring","handleUpload","target","files","item","uploadImage","inputWrapper","ViewImage","imgStyle","display","objectFit","width","height","handleChange","viewImage","margin"],"mappings":"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","sourcesContent":["import {useEffect, useState, createRef} from \"react\";\nimport {FORM_STORE} from \"lib/stores\";\nimport {Resizable} from \"re-resizable\";\nimport style from \"./styles/imgfield.module.scss\";\n\nconst\n{useFormContext} = FORM_STORE,\nmime = [\n  \"image/jpeg\",\n  \"image/png\",\n  \"image/gif\",\n  \"image/webp\",\n  \"image/svg+xml\",\n  \"image/tiff\",\n  \"image/bmp\",\n],\nmimeAccept = mime.reduce((acc, cur) => acc.concat(\",\", cur));\n\nexport function ImageField() {\n  const {fields, edit, setForm} = useFormContext(),\n        img = fields.img;\n\n  if (fields.img instanceof File) return (\n    <UploadedImage fields={fields} edit={edit} setForm={setForm} img={img}/>\n  ); else if (!Object.keys(img).length) return (\n    <UploadImage fields={fields} edit={edit} setForm={setForm} img={img}/>\n  ); else return (\n    <ViewImage edit={edit} setForm={setForm} img={img}/>\n  );\n}\n\nfunction UploadedImage({fields, edit, setForm, img}) {\n\n  function handleCancel(e) {\n    e.preventDefault();\n    setForm(\"setInput\", \"img\", {});\n  }\n  return (\n    <div className={style.imageUploaded}>\n      <p>{fields.img.name}</p>\n      <p onClick={handleCancel}>cancel</p>\n    </div>\n  );\n}\nfunction UploadImage({edit, setForm}) {\n  const id = (Math.random() + 1).toString(36).substring(7);\n\n  function handleUpload(e) {\n    e.preventDefault();\n    if (!edit) return;\n    setForm(\"setInput\", \"img\", e.target.files.item(0));\n  }\n\n  return (\n    <div className={style.uploadImage}>\n      <label className={style.inputWrapper} htmlFor={id}>\n        <span>upload</span>\n        <input type=\"file\"\n               id={id}\n               name=\"img\"\n               accept={mimeAccept}\n               onChange={handleUpload}\n        />\n      </label>\n    </div>\n  );\n}\n\nfunction ViewImage({fields, edit, setForm, img}) {\n  const imgStyle = {\n    display: \"inline-block\",\n    objectFit: \"cover\",\n    width: \"100%\",\n    height: \"100%\",\n  };\n\n  function handleChange(e) {\n    e.preventDefault();\n    if (!edit) return;\n    setForm(\"setInput\", \"img\", {});\n  }\n\n  return (\n    <div className={style.viewImage}>\n      <p onClick={handleChange}>change</p>\n      <Resizable\n        style={{margin: \"auto\"}}\n        minHeight={80}\n        width={\"100%\"}\n        height={\"100%\"}\n        minWidth={90}\n        maxWidth={300}\n        maxHeight={300}\n        defaultSize={{width: 90, height: 80}}>\n        <img style={imgStyle} src={img}/>\n      </Resizable>\n    </div>\n  );\n}\n\n"]},"metadata":{},"sourceType":"module"}